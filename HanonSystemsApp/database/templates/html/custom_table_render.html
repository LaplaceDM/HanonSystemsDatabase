<table class="table table-bordered table-striped">
    <thead>
        <tr>
            {% for column in table.columns %}
                <th class="{% if forloop.counter == 1 or forloop.counter == 2 or forloop.counter == 3 or forloop.counter == 4 or forloop.counter == 5 or forloop.counter == 6 or forloop.counter == 7 or forloop.counter == 8 or forloop.counter == 9 or forloop.counter == 10 or forloop.counter == 11%}frozen-column{% endif %}">
                    <!-- Sorting link for each column -->
                    <a href="?sort={{ column.name }}&order={% if request.GET.sort == column.name and request.GET.order == 'asc' %}desc{% else %}asc{% endif %}">
                        {{ column.header }}
                        {% if request.GET.sort == column.name %}
                            {% if request.GET.order == 'asc' %}
                                ▲
                            {% else %}
                                ▼
                            {% endif %}
                        {% endif %}
                    </a>
                    
                    <!-- Existing legend buttons and content -->
                    {% if forloop.counter == 6 %}
                        <button class="legend-button">?</button>
                        <div class="legend-content">
                            <div class="notation">
                                <div id="grey_box"></div>
                                Completed/ Cancelled
                            </div>
                            <div class="notation">
                                <div id="orange_box"></div>
                                Priority 1
                            </div>
                            <div class="notation">
                                <div id="yellow_box"></div>
                                Priority 2
                            </div>
                            <div class="notation">
                                <div id="dark_orange_box"></div>
                                Priority 3
                            </div>
                        </div>
                    {% elif forloop.counter == 7 %}
                        <button class="legend-button">?</button>
                        <div class="legend-content">
                            <div class="notation">
                                <div id="green_box"></div>
                                Running/ Data Review/ On track
                            </div>
                            <div class="notation">
                                <div id="yellow_box"></div>
                                Set up
                            </div>
                            <div id="red_box"></div>
                            Stopped/ On hold
                            <div class="notation">
                                <div id="purple_box"></div>
                                No man power
                            </div>
                        </div>
                    {% endif %}
                </th>
            {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% for row in table.rows %}
            <tr class="{% if forloop.counter0|divisibleby:2 %}even-row{% else %}odd-row{% endif %}">
                {% for cell in row %}
                    <td class="{% if forloop.counter == 1 or forloop.counter == 2 or forloop.counter == 3 %}frozen-column{% endif %}">
                        {% if forloop.counter == 18 %}
                            <div class="scrollable">{{ cell }}</div>
                        {% else %}
                            {{ cell }}
                        {% endif %}
                    </td>
                {% endfor %}
            </tr>
        {% endfor %}
    </tbody>
</table>

<style>
/* 固定表格标题 */
.table thead tr {
    position: sticky;
    top: 0;
    z-index: 2;
    background-color: white;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* 冻结列的样式 */
.table th.frozen-column, .table td.frozen-column {
    position: sticky;
    background-color: white;
    z-index: 1;
    box-shadow: 2px 0px 5px rgba(0,0,0,0.1);
    width: 70px;  /* Set a fixed width */
}

/* Adjust the left position and width for each frozen column */
    .table th.frozen-column:nth-child(1), .table td.frozen-column:nth-child(1) { 
        left: 0; 
        width: 70px;   /* Created */
    }
    
    .table th.frozen-column:nth-child(2), .table td.frozen-column:nth-child(2) { 
        left: 70px; 
        width: 140px;   /* Product */
    }
    
    .table th.frozen-column:nth-child(3), .table td.frozen-column:nth-child(3) { 
        left: 140px; 
        width: 210px;   /* Program */
    }

    .table th.frozen-column:nth-child(4), .table td.frozen-column:nth-child(4) { 
        left: 210px; 
        width: 280px;
    }

    .table th.frozen-column:nth-child(5), .table td.frozen-column:nth-child(5) { 
        left: 280px; 
        width: 350px;
    }

    .table th.frozen-column:nth-child(6), .table td.frozen-column:nth-child(6) { 
        left: 350px; 
        width: 420px;
    }

    .table th.frozen-column:nth-child(7), .table td.frozen-column:nth-child(7) { 
        left: 420px; 
        width: 490px;
    }

    .table th.frozen-column:nth-child(8), .table td.frozen-column:nth-child(8) { 
        left: 490px; 
        width: 560px;
    }

    .table th.frozen-column:nth-child(9), .table td.frozen-column:nth-child(9) { 
        left: 560px; 
        width: 630px;
        max-width: 100px;
    }

    .table th.frozen-column:nth-child(10), .table td.frozen-column:nth-child(10) { 
        left: 630px; 
        width: 700px;
    }

    .table th.frozen-column:nth-child(11), .table td.frozen-column:nth-child(11) { 
        left: 700px; 
        width: 770px;
    }
    

/* 冻结列的位置 */
.table th.frozen-column:nth-child(1), .table td.frozen-column:nth-child(1) { left: 0; }   /* Created */
.table th.frozen-column:nth-child(2), .table td.frozen-column:nth-child(2) { left: 60px; } /* Product */
.table th.frozen-column:nth-child(3), .table td.frozen-column:nth-child(3) { left: 100px; } /* Program */
.table th.frozen-column:nth-child(4), .table td.frozen-column:nth-child(4) { left: 140px; } 
.table th.frozen-column:nth-child(5), .table td.frozen-column:nth-child(5) { left: 180px; } 
.table th.frozen-column:nth-child(6), .table td.frozen-column:nth-child(6) { left: 220px; } 
.table th.frozen-column:nth-child(7), .table td.frozen-column:nth-child(7) { left: 260px; } 
.table th.frozen-column:nth-child(8), .table td.frozen-column:nth-child(8) { left: 300px; } 
.table th.frozen-column:nth-child(9), .table td.frozen-column:nth-child(9) { left: 340px; } 
.table th.frozen-column:nth-child(10), .table td.frozen-column:nth-child(10) { left: 380px; } 
.table th.frozen-column:nth-child(11), .table td.frozen-column:nth-child(11) { left: 420px; } 
</style>